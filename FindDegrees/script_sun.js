const SunData = {
  "Stellenbosch University (SUN)": [
    {
      degree: "BSc in Mathematical Sciences (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 50,
        "English First Additional Language": 50,
        "Physical Sciences": 50,
         "Mathematics": 70,
      },
    },
    {
      degree: "Bachelor of Data Science (BDatSci) (4 years)",
      requirements: {
        "NSC average": 80,
        "Afrikaans Huistaal": 60,
        "Afrikaans Eerste Addisionele Taal": 75,
        "English Home Language": 60,
        "English First Additional Language": 75,
        "Mathematics": 80,
      },
    },
    {
      degree: "BSc in Physics (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "Physical Sciences": 50,
      },
    },
    {
      degree: "BSc in Computer Science (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "Mathematics": 70,
        "Physical Sciences": 50,
      },
    },
    {
      degree: "BSc in GeoInformatics (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "Physical Sciences": 50,
        "Mathematics": 60,
      },
    },
    {
      degree: "BSc in Sport Science (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "Physical Sciences": 50,
      },
    },
    {
      degree: "BSc in Earth Science (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "Physical Sciences": 50,
        "Mathematics": 60,
      },
    },
    {
      degree: "BSc in Food Science (4 years)",
      requirements: {
        "NSC average": 60,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 50,
        "English First Additional Language": 50,
        "Mathematics": 60,
        "Physical Sciences": 50,
      },
    },
    {
      degree: "BAgric in Agricultural Production and Management: Elsenburg (3 years)",
      requirements: {
        "NSC average": 60,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 50,
        "English First Additional Language": 50,
        "Mathematics": 60,
        "Physical Sciences": 50,
      },
    },
    {
      degree: "BAgric in Agribusiness Management (3 years)",
      requirements: {
        "NSC average": 60,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 50,
        "English First Additional Language": 50,
        "Mathematics": 60,
        "Physical Sciences": 50,
      },
    },
    {
      degree: "BScAgric in Agricultural Economic Analysis and Management (4 years)",
      requirements: {
        "NSC average": 60,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 50,
        "English First Additional Language": 50,
        "Mathematics": 60,
        "Physical Sciences": 50,
      },
    },
    {
      degree: "BCom (Management Sciences) with focal area: Agricultural Economics (3 years)",
      requirements: {
        "NSC average": 60,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 50,
        "English First Additional Language": 50,
        "Mathematics": 60,
        "Physical Sciences": 50,
      },
    },
    {
      degree: "MBChB (6 years)",
      requirements: {
        "NSC average": 75,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 50,
        "English First Additional Language": 50,
        "Mathematics": 60,
        "Physical Sciences": 50,
        "Life Sciences": 50,
      },
    },
    {
      degree: "Bachelor of Nursing (4 years)",
      requirements: {
        "NSC average": 60,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 50,
        "English First Additional Language": 50,
        "Mathematics": 40,
        "Life Sciences": 50,
      },
    },
    {
      degree: "BCom (International Business) (4 years)",
      requirements: {
        "NSC average": 80,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 70,
        "English First Additional Language": 80,
        "Mathematics": 70,
      },
    },
    {
      degree: "BCom (Actuarial Science) (3 years)",
      requirements: {
        "NSC average": 80,
        "Afrikaans Huistaal": 60,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 60,
        "English First Additional Language": 75,
        "Mathematics": 80,
      },
    },
    {
      degree: "BAcc (3 years)",
      requirements: {
        "NSC average": 70,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 60,
        "English Home Language": 50,
        "English First Additional Language": 60,
        "Mathematics": 70,
      },
    },
    {
      degree: "BCom (Financial Accounting) (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 60,
        "English Home Language": 50,
        "English First Additional Language": 60,
        "Mathematics": 60,
      },
    },
    {
      degree: "BCom (Management Accounting) (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 60,
        "English Home Language": 50,
        "English First Additional Language": 60,
        "Mathematics": 60,
      },
    },
    {
      degree: "BCom (Industrial Psychology) (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 60,
        "English Home Language": 50,
        "English First Additional Language": 60,
        "Mathematics": 60,
      },
    },
    {
      degree: "BCom (Management Sciences) (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 60,
        "English Home Language": 50,
        "English First Additional Language": 60,
        "Mathematics": 60,
      },
    },
    {
      degree: "BCom (Economic Sciences) (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 50,
        "Afrikaans Eerste Addisionele Taal": 60,
        "English Home Language": 50,
        "English First Additional Language": 60,
        "Mathematics": 60,
      },
    },
    {
      degree: "BCom (Law) (3 years)",
      requirements: {
        "NSC average": 65,
        "Afrikaans Huistaal": 60,
        "Afrikaans Eerste Addisionele Taal": 70,
        "English Home Language": 60,
        "English First Additional Language": 70,
        "Mathematics": 60,
      },
    },
    {
      degree: "BAccLLB (5 years)",
      requirements: {
        "NSC average": 80,
        "Afrikaans Huistaal": 60,
        "Afrikaans Eerste Addisionele Taal": 50,
        "English Home Language": 60,
        "English First Additional Language": 70,
        "Mathematics": 70,
      },
    },
    {
      degree: "LLB (three-year)",
      requirements: {
        "Final year average": 60,
      },
    },
    {
      degree: "BA (Law) (3 years)",
      requirements: {
        "NSC average": 70,
        "Afrikaans Huistaal": 60,
        "Afrikaans Eerste Addisionele Taal": 70,
        "English Home Language": 60,
        "English First Additional Language": 70,
        "Mathematics": 60,
      },
    },
  ],
};

let subjectCounter = 0;

let subjectCounter = 0; // Declare subjectCounter variable

function addSubject() {
    if (subjectCounter >= 7) {
        alert("You can only select up to 7 subjects.");
        return;
    }
    subjectCounter++;

    const subjectContainer = document.createElement("div");
    subjectContainer.classList.add("subject-wrapper");

    const subjectDiv = document.createElement("div");
    subjectDiv.classList.add("subject-container");

    const select = document.createElement("select");
    select.classList.add("subject");
    select.id = "subjects" + subjectCounter;

    const option = document.createElement("option");
    option.value = "";
    option.textContent = "Select a subject";
    select.appendChild(option);

    // Define categories
    const categories = {
        "Language 1": ["English Home Language", "Afrikaans Huistaal", "Sesotho Home Language", "Siswati Home Language", "Setswana Home Language", "isiZulu Home Language", "isiXhosa Home Language", "isiNdebele Home Language", "Sepedi Home Language", "Xitsonga Home Language", "Tshivenda Home Language"],
        "Language 2": ["English First Additional Language", "Afrikaans Eerste Additionele Taal"],
        "Maths": ["Mathematics", "Mathematical Literacy", "Technical Mathematics"],
        "LO": ["Life Orientation"],
        "Subject 5": ["Computer Applications Technology", "Economics", "Physical Sciences", "Life Sciences", "Agricultural Sciences", "Business Studies", "Accounting", "Information Technology", "History", "Geography", "Religious Studies", "History", "Tourism"],
        "Subject 6": ["Computer Applications Technology", "Economics", "Physical Sciences", "Life Sciences", "Agricultural Sciences", "Business Studies", "Accounting", "Information Technology", "History", "Geography", "Religious Studies", "History", "Tourism"],
        "Subject 7": ["Computer Applications Technology", "Economics", "Physical Sciences", "Life Sciences", "Agricultural Sciences", "Business Studies", "Accounting", "Information Technology", "History", "Geography", "Religious Studies", "History", "Tourism"],
    };

    // Populate select options based on categories
    for (const category in categories) {
        const optgroup = document.createElement("optgroup");
        optgroup.label = category;
        categories[category].forEach(subject => {
            const option = document.createElement("option");
            option.value = subject;
            option.textContent = subject;
            optgroup.appendChild(option);
        });
        select.appendChild(optgroup);
    }

    subjectDiv.appendChild(select);

    const input = document.createElement("input");
    input.type = "number";
    input.classList.add("percentage-input");
    input.id = "percentage" + subjectCounter;
    input.min = "0";
    input.max = "100";
    input.placeholder = "%";
    input.style.width = "50px";
    input.value = "75";

    subjectDiv.appendChild(input);

    const deleteButton = document.createElement("button");
    deleteButton.classList.add("delete-button");
    deleteButton.textContent = "Delete";
    deleteButton.onclick = function() { deleteSubject(this); };
    subjectDiv.appendChild(deleteButton);

    subjectContainer.appendChild(subjectDiv);
    document.getElementById("subject-container").appendChild(subjectContainer);
}

// Function to delete a subject
function deleteSubject(button) {
    const subjectContainer = button.closest('.subject-wrapper');
    subjectContainer.remove();
    subjectCounter--;
}

// Function to display eligible degrees based on user inputs
function displayEligibleDegrees() {
    // Get the selected subjects and percentages from the form
    const selectedSubjects = [];
    const subjectElements = document.querySelectorAll('.subject');
    subjectElements.forEach(select => {
        if (select.value !== "") {
            selectedSubjects.push(select.value);
        }
    });

    const percentageInputs = document.querySelectorAll('.percentage-input');
    const percentages = Array.from(percentageInputs).map(input => parseInt(input.value));

    // Get the NSC average from the form
    const averageInput = document.getElementById('average');
    const nscAverage = parseInt(averageInput.value);

    // Initialize an array to store eligible degrees
    let eligibleDegrees = [];

    // Iterate through each degree in the SunData
    SunData["Stellenbosch University (SUN)"].forEach(degree => {
        // Flag to track if all subject requirements are met
        let allSubjectsMet = true;

        // Check if each subject requirement is met
        Object.keys(degree.requirements).forEach(subject => {
            if (subject === "NSC average") {
                if (nscAverage < degree.requirements[subject]) {
                    allSubjectsMet = false;
                }
            } else if (subject === "APS") {
                // Check APS requirement if needed  
            } else if (subject === "English Home Language" || subject === "English First Additional Language") {
                // Check if either English Home Language or English First Additional Language meets the requirement
                let englishSubjectIndex = selectedSubjects.indexOf("English Home Language");
                let additionalEnglishSubjectIndex = selectedSubjects.indexOf("English First Additional Language");
                if ((englishSubjectIndex === -1 || percentages[englishSubjectIndex] < degree.requirements[subject]) &&
                    (additionalEnglishSubjectIndex === -1 || percentages[additionalEnglishSubjectIndex] < degree.requirements[subject])) {
                    allSubjectsMet = false;
                }
            } else if (subject === "Afrikaans Huistaal" || subject === "Afrikaans Eerste Additionele Taal") {
                // Check if either Afrikaans Huistaal or Afrikaans Eerste Additionele Taal meets the requirement
                let afrikaansSubjectIndex = selectedSubjects.indexOf("Afrikaans Huistaal");
                let additionalAfrikaansSubjectIndex = selectedSubjects.indexOf("Afrikaans Eerste Additionele Taal");
                if (afrikaansSubjectIndex === -1 && additionalAfrikaansSubjectIndex === -1) {
                    allSubjectsMet = false;
                }
            } else {
                // Check individual subject requirements if needed
                let subjectIndex = selectedSubjects.indexOf(subject);
                if (subjectIndex !== -1) {
                    let subjectPercentage = percentages[subjectIndex];
                    if (subjectPercentage < degree.requirements[subject]) {
                        allSubjectsMet = false;
                    }
                } else {
                    allSubjectsMet = false;
                }
            }
        });

        // If all subject requirements are met, add the degree to eligibleDegrees
        if (allSubjectsMet) {
            eligibleDegrees.push(degree);
        }
    });

    // Display the eligible degrees on the screen
    let resultsDiv = document.getElementById('results');
    resultsDiv.innerHTML = "<h2>Eligible Degrees:</h2>";
    if (eligibleDegrees.length > 0) {
        let list = document.createElement('ul');
        eligibleDegrees.forEach(degree => {
            let listItem = document.createElement('li');
            let link = document.createElement('a');
            link.textContent = degree.degree;
            //  link.href = degree.websiteURL; // Set the href to the website URL
            // link.target = "_blank"; // Open the link in a new tab
            listItem.appendChild(link);

            // Add a link to the official university booklet
            let bookletLink = document.createElement('a');
            bookletLink.textContent = "University Booklet";
            bookletLink.href = "https://www.sun.ac.za/english/maties/Documents/Admission%20booklet%202025%20%28English%29.pdf";
            bookletLink.target = "_blank";
            listItem.appendChild(document.createTextNode(" "));
            listItem.appendChild(bookletLink);

            list.appendChild(listItem);
        });
        resultsDiv.appendChild(list);
    } else {
        resultsDiv.innerHTML += "<p>No degrees found matching your criteria.</p>";
    }
}

// Function to calculate the level based on the percentage
function calculateLevel(percentage) {
    if (percentage >= 80) return 7;
    else if (percentage >= 70) return 6;
    else if (percentage >= 60) return 5;
    else if (percentage >= 50) return 4;
    else if (percentage >= 40) return 3;
    else if (percentage >= 30) return 2;
    else return 1;
}
